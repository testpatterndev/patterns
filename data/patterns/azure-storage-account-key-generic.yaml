schema: testpattern/v1
name: Azure Storage Account Key (Generic)
slug: azure-storage-account-key-generic
version: 1.0.0
type: regex
engine: universal
description: Detects generic Azure Storage account key patterns including keys assigned
  to variables or configuration properties. This pattern is based on a Microsoft Purview
  built-in sensitive information type. Users already running Purview may prefer to
  enable the built-in SIT directly, or use this version as a starting point for customisation.
operation: 'Matches Azure Storage account keys in assignment context (key=value or
  key:value format) with Base64-encoded values. This is a broader variant that catches
  keys in configuration files and code. Corroborative evidence: 8 keywords within
  300 characters. Keyword lists: credentials-api-keys. Uses additional domain-context
  evidence and explicit exclusion logic for template/sample/test text.'
pattern: (?i)(?:storage[._-]?key|account[._-]?key|storage[._-]?account[._-]?key)\s*[:=]\s*"?[A-Za-z0-9+/]{43,88}={0,2}"?
confidence: medium
confidence_justification: 'Medium confidence: matches storage key assignments but
  the Base64 pattern can overlap with other encoded data. Context keywords improve
  accuracy. Added context gating and exclusion rules improve precision and reduce
  incidental matches.'
jurisdictions:
- global
regulations:
- general-data-protection
data_categories:
- credentials
- security
corroborative_evidence:
  keywords:
  - storage account
  - storage key
  - account key
  - Azure Storage
  - blob storage
  - core.windows.net
  - access key
  - container
  proximity: 300
  keyword_lists:
  - credentials-api-keys
test_cases:
  should_match:
  - value: storage_key=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==
    description: Storage key in assignment (88 chars)
  - value: 'account_key: "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUV=="'
    description: Account key in YAML format
  - value: storage_account_key="000000000000000000000000000000000000000000000="
    description: Storage account key with placeholder value
  should_not_match:
  - value: storage_key=""
    description: Empty key value
  - value: storage_key=tooshort
    description: Value too short to be a storage key
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Configuration templates with placeholder storage key values.
  mitigation: Check for common placeholder patterns and template indicators.
- description: Non-Azure storage service keys that use similar naming.
  mitigation: Require proximity to Azure-specific keywords for differentiation.
exports:
- purview_xml
- yaml
- regex_copy
scope: specific
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
  - confidence_level: 90
    id_match: Regex_azure_storage_account_key_generic
    matches:
    - ref: Pattern_azure_storage_account_key_generic_label_context
    - ref: Keyword_azure_storage_account_key_generic_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_azure_storage_account_key_generic_noise_exclusion
  - confidence_level: 85
    id_match: Regex_azure_storage_account_key_generic
    matches:
    - ref: Keyword_azure_storage_key_generic
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_azure_storage_account_key_generic_noise_exclusion
  regexes:
  - id: Regex_azure_storage_account_key_generic
    pattern: (?i)(?:storage[._-]?key|account[._-]?key|storage[._-]?account[._-]?key)\s*[:=]\s*"?[A-Za-z0-9+/]{43,88}={0,2}"?
  - id: Pattern_azure_storage_account_key_generic_label_context
    pattern: (?i)\\b(?:azure\\s+storage\\s+account\\s+key\\s+\(generic\)|azure|storage|account|key|generic)\\b
  keywords:
  - id: Keyword_azure_storage_key_generic
    groups:
    - match_style: word
      terms:
      - storage account
      - storage key
      - account key
      - Azure Storage
      - blob storage
      - core.windows.net
      - access key
      - container
      - AccountKey
      - configuration
      - app settings
  - id: Keyword_azure_storage_account_key_generic_domain_context
    groups:
    - match_style: word
      terms:
      - azure storage account key (generic)
      - azure
      - storage
      - account
      - key
      - generic
      - field
      - identifier
      - reference
  - id: Keyword_azure_storage_account_key_generic_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 10
risk_description: Exposure of this credential could grant unauthorized access to cloud
  infrastructure, databases, or services. Compromised credentials are a leading cause
  of data breaches and can result in full system takeover.
sensitivity_labels:
  pspf: PROTECTED
  qgiscf: PROTECTED
  qgiscf_dlm: PROTECTED
  us_gov: CUI Specified
  uk_gov: OFFICIAL-SENSITIVE
  nz_gov: RESTRICTED
  ca_gov: Protected B
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-azure-storage-account-key-generic
  title: Azure Storage account key (generic) entity definition - Microsoft Learn
created: '2026-02-09'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
