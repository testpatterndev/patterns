schema: testpattern/v1
name: Azure Service Bus Shared Access Signature
slug: azure-service-bus-shared-access-signature
version: 1.0.0
type: regex
engine: universal
description: Detects Azure Service Bus Shared Access Signature (SAS) token patterns.
  This pattern is based on a Microsoft Purview built-in sensitive information type.
  Users already running Purview may prefer to enable the built-in SIT directly, or
  use this version as a starting point for customisation.
operation: 'Matches Service Bus SAS tokens containing sr (resource), sig (signature),
  se (expiry), and skn (key name) parameters in URL format. Corroborative evidence:
  8 keywords within 300 characters. Keyword lists: credentials-api-keys. Uses additional
  domain-context evidence and explicit exclusion logic for template/sample/test text.'
pattern: (?i)SharedAccessSignature\s+sr=[^&]+&sig=[A-Za-z0-9%+/=]+&se=\d+&skn=[A-Za-z0-9_]+
confidence: high
confidence_justification: 'High confidence: SharedAccessSignature prefix combined
  with sr, sig, se, and skn parameters is structurally unique to Azure Service Bus
  SAS tokens. Added context gating and exclusion rules improve precision and reduce
  incidental matches.'
jurisdictions:
- global
regulations:
- general-data-protection
data_categories:
- credentials
- security
corroborative_evidence:
  keywords:
  - Service Bus
  - SharedAccessSignature
  - SAS token
  - sr=
  - sig=
  - skn=
  - authorization
  - namespace
  proximity: 300
  keyword_lists:
  - credentials-api-keys
test_cases:
  should_match:
  - value: SharedAccessSignature sr=https%3a%2f%2fmynamespace.servicebus.windows.net&sig=AAAA0000%3d&se=1735689600&skn=RootManageSharedAccessKey
    description: Service Bus SAS token
  - value: SharedAccessSignature sr=sb%3a%2f%2ftest-ns.servicebus.windows.net&sig=000000000%3d&se=9999999999&skn=sendpolicy
    description: Service Bus SAS for send policy
  - value: SharedAccessSignature sr=mynamespace&sig=ABCDEFghijkl%2B%3D&se=1700000000&skn=listen
    description: Service Bus SAS for listen policy
  should_not_match:
  - value: SharedAccessSignature sr=myresource
    description: Incomplete SAS token without sig
  - value: Authorization=Bearer eyJhbGciOiJIUzI1NiJ9
    description: Bearer token, not SAS
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Service Bus documentation with example SAS tokens.
  mitigation: Check for common placeholder values in the sig parameter.
- description: Expired SAS tokens that no longer grant access.
  mitigation: Check se= (expiry) parameter but flag regardless since the token reveals
    infrastructure details.
exports:
- purview_xml
- yaml
- regex_copy
scope: specific
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
  - confidence_level: 90
    id_match: Regex_azure_service_bus_sas
    matches:
    - ref: Pattern_azure_service_bus_shared_access_signature_label_context
    - ref: Keyword_azure_service_bus_shared_access_signature_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_azure_service_bus_shared_access_signature_noise_exclusion
  - confidence_level: 85
    id_match: Regex_azure_service_bus_sas
    matches:
    - ref: Keyword_azure_service_bus_sas
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_azure_service_bus_shared_access_signature_noise_exclusion
  regexes:
  - id: Regex_azure_service_bus_sas
    pattern: (?i)SharedAccessSignature\s+sr=[^&]+&sig=[A-Za-z0-9%+/=]+&se=\d+&skn=[A-Za-z0-9_]+
  - id: Pattern_azure_service_bus_shared_access_signature_label_context
    pattern: (?i)\\b(?:azure\\s+service\\s+bus\\s+shared\\s+access\\s+signature|azure|service|bus|shared|access|signature)\\b
  keywords:
  - id: Keyword_azure_service_bus_sas
    groups:
    - match_style: word
      terms:
      - Service Bus
      - SharedAccessSignature
      - SAS token
      - authorization
      - namespace
      - servicebus.windows.net
      - queue
      - topic
      - relay
      - shared access policy
      - RootManageSharedAccessKey
  - id: Keyword_azure_service_bus_shared_access_signature_domain_context
    groups:
    - match_style: word
      terms:
      - azure service bus shared access signature
      - azure
      - service
      - bus
      - shared
      - access
      - signature
      - field
      - identifier
      - reference
  - id: Keyword_azure_service_bus_shared_access_signature_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 10
risk_description: Exposure of this credential could grant unauthorized access to cloud
  infrastructure, databases, or services. Compromised credentials are a leading cause
  of data breaches and can result in full system takeover.
sensitivity_labels:
  pspf: PROTECTED
  qgiscf: PROTECTED
  qgiscf_dlm: PROTECTED
  us_gov: CUI Specified
  uk_gov: OFFICIAL-SENSITIVE
  nz_gov: RESTRICTED
  ca_gov: Protected B
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-azure-service-bus-shared-access-signature
  title: Azure Service Bus shared access signature entity definition - Microsoft Learn
created: '2026-02-09'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
