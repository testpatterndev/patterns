schema: testpattern/v1
name: New Zealand Ministry of Health Number
slug: nz-ministry-of-health-number
version: 1.0.0
type: regex
engine: universal
description: >-
  Detects New Zealand Ministry of Health Number patterns. This pattern is based on a Microsoft Purview built-in
  sensitive information type. Due to the generic numeric format, corroborative evidence keywords
  are essential for reliable detection.
operation: >-
  Corroborative evidence: 5 keywords within 300 characters.
  Keyword lists: nhi, nz-health.
pattern: '\b[A-Z]{3}\d{4}\b'
confidence: high
confidence_justification: >-
  High confidence: the three-letter-four-digit format is relatively distinctive. Combined with NHI-related keywords, this pattern reliably identifies New Zealand Ministry of Health numbers.
jurisdictions:
  - nz
regulations:
  - privacy-act-2020
  - health-information-privacy-code
data_categories:
  - phi
  - health
  - government-id
corroborative_evidence:
  keywords:
    - NHI
    - national health index
    - ministry of health
    - health number
    - NHI number
  proximity: 300
  keyword_lists:
    - nhi
    - nz-health
test_cases:
  should_match:
    - value: 'ZZZ1234'
      description: Standard NHI number format with three letters and four digits
    - value: 'ABC5678'
      description: NHI number with uppercase letters and digits
    - value: 'XYZ9012'
      description: NHI format identifier
  should_not_match:
    - value: 'ZZ1234'
      description: Only two letters, too short for NHI format
    - value: 'ABCD5678'
      description: Four letters, exceeds NHI letter prefix length
false_positives:
  - description: Generic numeric sequences matching the digit pattern in non-health contexts
    mitigation: >-
      Require corroborative evidence keywords within the proximity window to distinguish
      health identifiers from general numeric data.
  - description: Reference numbers or account identifiers from other domains with similar digit counts
    mitigation: >-
      Layer with document classification to prioritise matches in health and medical documents.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: narrow
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
    - confidence_level: 85
      id_match: Regex_nz_nhi
      matches:
        - ref: Keyword_nz_nhi
    - confidence_level: 75
      id_match: Regex_nz_nhi
  regexes:
    - id: Regex_nz_nhi
      pattern: '\b[A-Z]{3}\d{4}\b'
  keywords:
    - id: Keyword_nz_nhi
      groups:
        - match_style: word
          terms:
            - NHI
            - national health index
            - NHI number
            - ministry of health
            - health number
            - health index number
            - patient number
            - patient identifier
            - health identifier
            - medical record number
            - health practitioner index
            - health service
risk_rating: 8
risk_description: >-
  Health and medical information is among the most sensitive personal data under privacy laws globally. Unauthorized disclosure can result in discrimination, personal harm, and regulatory penalties under health privacy frameworks.
sensitivity_labels:
  pspf: "OFFICIAL: Sensitive"
  qgiscf: "SENSITIVE"
  qgiscf_dlm: "SENSITIVE Personal-Privacy"
  us_gov: "CUI Specified"
  uk_gov: "OFFICIAL-SENSITIVE"
  nz_gov: "CONFIDENTIAL"
  ca_gov: "Protected B"
references:
  - url: https://learn.microsoft.com/en-us/purview/sit-defn-new-zealand-ministry-of-health-number
    title: "New Zealand Ministry of Health Number entity definition - Microsoft Learn"
created: '2026-02-09'
updated: '2026-02-09'
author: testpattern-community
source: microsoft
license: MIT
