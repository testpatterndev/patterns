schema: testpattern/v1
name: Azure IoT Connection String
slug: azure-iot-connection-string
version: 1.0.0
type: regex
engine: universal
description: >-
  Detects Azure IoT Hub connection string patterns. This pattern is based on a Microsoft Purview built-in sensitive
  information type. Users already running Purview may prefer to enable the built-in SIT directly, or use this version as a
  starting point for customisation.
operation: >-
  Matches Azure IoT Hub connection strings containing HostName, SharedAccessKeyName, and SharedAccessKey parameters.
  Corroborative evidence: 8 keywords within 300 characters. Keyword lists: credentials-api-keys.
pattern: (?i)HostName\s*=\s*[^;]+\.azure-devices\.net\s*;\s*(SharedAccessKeyName|DeviceId)\s*=\s*[^;]+\s*;\s*SharedAccessKey\s*=\s*[A-Za-z0-9+/]{20,50}={0,2}
confidence: high
confidence_justification: >-
  High confidence: azure-devices.net hostname combined with SharedAccessKey structure provides strong structural
  constraint.
jurisdictions:
  - global
regulations:
  - general-data-protection
data_categories:
  - credentials
  - security
corroborative_evidence:
  keywords:
    - IoT Hub
    - azure-devices.net
    - SharedAccessKey
    - HostName
    - DeviceId
    - IoT
    - connection string
    - device connection
  proximity: 300
  keyword_lists:
    - credentials-api-keys
test_cases:
  should_match:
    - value: HostName=myhub.azure-devices.net;SharedAccessKeyName=iothubowner;SharedAccessKey=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==
      description: IoT Hub owner connection string
    - value: HostName=testhub.azure-devices.net;DeviceId=device1;SharedAccessKey=00000000000000000000000000000000000000==
      description: IoT device connection string
    - value: HostName=prod-hub.azure-devices.net;SharedAccessKeyName=service;SharedAccessKey=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefgh==
      description: IoT Hub service connection string
  should_not_match:
    - value: HostName=myhub.azure-devices.net;SharedAccessKeyName=iothubowner
      description: Missing SharedAccessKey parameter
    - value: HostName=myserver.database.windows.net;User=admin;Password=secret
      description: SQL connection string, not IoT
false_positives:
  - description: >-
      IoT Hub documentation and quickstart tutorials with placeholder connection strings.
    mitigation: >-
      Check for common placeholder values and documentation file indicators.
  - description: >-
      Test and development IoT Hub connection strings that do not provide production access.
    mitigation: >-
      Flag for review regardless of environment since test credentials can still expose infrastructure.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: specific
risk_rating: 10
risk_description: >-
  Exposure of this credential could grant unauthorized access to cloud infrastructure, databases, or services. Compromised
  credentials are a leading cause of data breaches and can result in full system takeover.
sensitivity_labels:
  pspf: "PROTECTED"
  qgiscf: "PROTECTED"
  qgiscf_dlm: "PROTECTED"
references:
  - url: https://learn.microsoft.com/en-us/purview/sit-defn-azure-iot-connection-string
    title: "Azure IoT connection string entity definition - Microsoft Learn"
created: '2026-02-09'
updated: '2026-02-09'
author: testpattern-community
source: microsoft
license: MIT
