schema: testpattern/v1
name: NHS Number
slug: uk-nhs-number
version: 1.0.0
type: regex
engine: boost_regex
description: >-
  Detects NHS Number patterns. This pattern is based on a Microsoft Purview built-in sensitive information type. Users already running Purview may prefer to enable the built-in SIT directly, or use this version as a starting point for customisation.
operation: >-
  Validation: Mod 11 with weights [10,9,8,7,6,5,4,3,2]. Reference:
  https://www.datadictionary.nhs.uk/attributes/nhs_number.html Corroborative evidence: 3 keywords within 300 characters.
  Keyword lists: healthcare-identifiers.
pattern: \b\d{3}\s?\d{3}\s?\d{4}\b
confidence: medium
confidence_justification: >-
  Medium confidence: pattern has structural constraints but corroborative keywords are recommended to reduce false
  positive rates.
jurisdictions:
  - uk
regulations:
  - uk-dpa-2018
data_categories:
  - pii
  - government-id
corroborative_evidence:
  keywords:
    - identifier
    - number
    - ID
  proximity: 300
  keyword_lists:
    - healthcare-identifiers
test_cases:
  should_match:
    - value: 123 456 7890
      description: Spaced NHS number
    - value: '1234567890'
      description: Continuous NHS number
    - value: 943 476 5919
      description: Real-format NHS number
  should_not_match:
    - value: 123 456 789
      description: Only 9 digits instead of 10
    - value: 123 456 78901
      description: 11 digits instead of 10
    - value: 123 456 789A
      description: Contains a letter instead of all digits
false_positives:
  - description: >-
      Common words and phrases related to nhs number appearing in policy documents, training materials, HR templates, or
      compliance guidelines without actual personal data.
    mitigation: >-
      Require corroborative evidence keywords within the proximity window to confirm sensitive data context rather than
      general discussion.
  - description: >-
      In British English, similar terminology used in formal or administrative contexts (education, professional
      documentation) that does not constitute sensitive data collection.
    mitigation: >-
      Layer with additional contextual signals such as structured identifiers, form fields, or database column headers
      to distinguish sensitive records from general references.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: narrow
risk_rating: 8
risk_description: >-
  Health and medical information is among the most sensitive personal data under privacy laws globally. Unauthorized
  disclosure can result in discrimination, personal harm, and regulatory penalties under health privacy frameworks.
sensitivity_labels:
  pspf: "OFFICIAL: Sensitive"
  qgiscf: "SENSITIVE"
  qgiscf_dlm: "SENSITIVE Personal-Privacy"
references:
  - url: https://learn.microsoft.com/en-us/purview/sit-defn-uk-national-health-service-number
    title: "U.K. national health service number entity definition - Microsoft Learn"
created: '2026-02-08'
updated: '2026-02-09'
author: testpattern-community
source: microsoft
license: MIT
