schema: testpattern/v1
name: Spain Driver's License Number
slug: es-drivers-license
version: 1.0.0
type: regex
engine: universal
description: Detects Spain driver's license number patterns. This pattern is based
  on a Microsoft Purview built-in sensitive information type. Users already running
  Purview may prefer to enable the built-in SIT directly, or use this version as a
  starting point for customisation.
operation: 'Matches 8 digits followed by 1 uppercase letter at word boundaries. Note
  this format is the same as the Spanish DNI. Corroborative evidence: 5 keywords within
  300 characters. Keyword lists: pii-civic-credentials. Uses additional domain-context
  evidence and explicit exclusion logic for template/sample/test text.'
pattern: \b\d{8}[A-Z]\b
confidence: medium
confidence_justification: 'Medium confidence: pattern has structural constraints but
  corroborative keywords are recommended to reduce false positive rates. Note the
  format overlaps with Spanish DNI numbers. Added context gating and exclusion rules
  improve precision and reduce incidental matches.'
jurisdictions:
- es
- eu
regulations:
- gdpr
data_categories:
- pii
- government-id
corroborative_evidence:
  keywords:
  - driver
  - licence
  - license
  - driving
  - DL
  - permiso de conducir
  proximity: 300
  keyword_lists:
  - pii-civic-credentials
test_cases:
  should_match:
  - value: 12345678A
    description: Standard Spanish driver's license format (8 digits + letter)
  - value: 98765432Z
    description: Another valid format with different trailing letter
  - value: 00123456X
    description: Valid format with leading zeros
  should_not_match:
  - value: '123456789'
    description: Missing trailing letter
  - value: 1234567A
    description: Too few digits (7 instead of 8)
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Spanish DNI (national identity document) numbers share the same format
    of 8 digits followed by a letter, making it impossible to distinguish between
    DNI and driver's license numbers by format alone.
  mitigation: Require corroborative evidence keywords specific to driver's license
    context within the proximity window.
exports:
- purview_xml
- yaml
- regex_copy
scope: narrow
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
  - confidence_level: 90
    id_match: Regex_es_drivers_license
    matches:
    - ref: Pattern_es_drivers_license_label_context
    - ref: Keyword_es_drivers_license_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_es_drivers_license_noise_exclusion
  - confidence_level: 85
    id_match: Regex_es_drivers_license
    matches:
    - ref: Keyword_es_drivers_license_specific
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_es_drivers_license_noise_exclusion
  - confidence_level: 75
    id_match: Regex_es_drivers_license
    matches:
    - ref: Keyword_es_drivers_license_general
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_es_drivers_license_noise_exclusion
  regexes:
  - id: Regex_es_drivers_license
    pattern: \b\d{8}[A-Z]\b
  - id: Pattern_es_drivers_license_label_context
    pattern: (?i)\\b(?:spain\\s+driver's\\s+license\\s+number|spain|driver|license|drivers)\\b
  keywords:
  - id: Keyword_es_drivers_license_specific
    groups:
    - match_style: word
      terms:
      - permiso de conducir
      - carné de conducir
      - carnet de conducir
      - licencia de conducir
      - driver's license
      - driving licence
      - driving license
      - permiso de conducción
      - DGT
  - id: Keyword_es_drivers_license_general
    groups:
    - match_style: word
      terms:
      - driver
      - licence
      - license
      - driving
      - DL
      - conducir
      - conductor
      - permiso
      - vehículo
  - id: Keyword_es_drivers_license_domain_context
    groups:
    - match_style: word
      terms:
      - spain driver's license number
      - spain
      - driver
      - license
      - drivers
      - field
      - identifier
      - reference
  - id: Keyword_es_drivers_license_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 6
risk_description: Driver's license numbers serve as government-issued identity verification
  and are used across many services. Exposure can enable identity fraud, unauthorized
  account creation, and social engineering attacks.
sensitivity_labels:
  pspf: 'OFFICIAL: Sensitive'
  qgiscf: SENSITIVE
  qgiscf_dlm: SENSITIVE Personal-Privacy
  us_gov: CUI
  uk_gov: OFFICIAL-SENSITIVE
  nz_gov: RESTRICTED
  ca_gov: Protected B
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-spain-drivers-license-number
  title: Spain driver's license number entity definition - Microsoft Learn
created: '2026-02-09'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
