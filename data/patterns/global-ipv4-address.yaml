schema: testpattern/v1
name: IPv4
slug: global-ipv4-address
version: 1.0.0
type: regex
engine: universal
description: Detects IPv4 patterns. This pattern is based on a Microsoft Purview built-in
  sensitive information type. Users already running Purview may prefer to enable the
  built-in SIT directly, or use this version as a starting point for customisation.
operation: 'Reference: https://datatracker.ietf.org/doc/html/rfc791 Corroborative
  evidence: 5 keywords within 300 characters. Keyword lists: pii-contact. Uses additional
  domain-context evidence and explicit exclusion logic for template/sample/test text.'
pattern: \b(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\b
confidence: high
confidence_justification: 'High confidence: structurally constrained pattern with
  corroborative keyword support reduces false positive rates significantly. Added
  context gating and exclusion rules improve precision and reduce incidental matches.'
jurisdictions:
- global
regulations:
- general-data-protection
data_categories:
- network
- pii
corroborative_evidence:
  keywords:
  - IP address
  - IP
  - network
  - host
  - server
  proximity: 300
  keyword_lists:
  - pii-contact
test_cases:
  should_match:
  - value: 192.168.1.1
    description: Private network IPv4 address
  - value: 10.0.0.1
    description: Class A private IPv4
  - value: 255.255.255.0
    description: Subnet mask
  should_not_match:
  - value: 256.168.1.1
    description: First octet exceeds 255
  - value: 192.168.1
    description: Only 3 octets instead of 4
  - value: 192.168.1.999
    description: Last octet exceeds valid range (999 > 255)
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Common words and phrases related to ipv4 appearing in policy documents,
    training materials, HR templates, or compliance guidelines without actual personal
    data.
  mitigation: Require corroborative evidence keywords within the proximity window
    to confirm sensitive data context rather than general discussion.
- description: In English (as the primary international business language), similar
    terminology used in formal or administrative contexts (education, professional
    documentation) that does not constitute sensitive data collection.
  mitigation: Layer with additional contextual signals such as structured identifiers,
    form fields, or database column headers to distinguish sensitive records from
    general references.
- description: High-frequency pattern matches in large document corpora due to broad
    regex anchors. Expected match rate is significantly higher than specific identifier
    patterns.
  mitigation: Tune confidence thresholds for bulk scanning. Consider using this pattern
    primarily as a pre-filter with secondary validation.
exports:
- purview_xml
- yaml
- regex_copy
scope: wide
purview:
  patterns_proximity: 300
  recommended_confidence: 75
  pattern_tiers:
  - confidence_level: 80
    id_match: Regex_ipv4_address
    matches:
    - ref: Pattern_global_ipv4_address_label_context
    - ref: Keyword_global_ipv4_address_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_ipv4_address_noise_exclusion
  - confidence_level: 75
    id_match: Regex_ipv4_address
    matches:
    - ref: Keyword_ipv4_address
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_ipv4_address_noise_exclusion
  - confidence_level: 65
    id_match: Regex_ipv4_address
    matches:
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_ipv4_address_noise_exclusion
  regexes:
  - id: Regex_ipv4_address
    pattern: \b(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\.(?:25[0-5]|2[0-4]\d|[01]?\d\d?)\b
  - id: Pattern_global_ipv4_address_label_context
    pattern: (?i)\\b(?:ipv4|address)\\b
  keywords:
  - id: Keyword_ipv4_address
    groups:
    - match_style: word
      terms:
      - IP address
      - IPv4
      - IP
      - network address
      - host address
      - server address
      - subnet
      - gateway
      - DHCP
      - DNS
      - firewall
      - router
  - id: Keyword_global_ipv4_address_domain_context
    groups:
    - match_style: word
      terms:
      - ipv4
      - address
      - field
      - identifier
      - reference
  - id: Keyword_global_ipv4_address_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 4
risk_description: IP addresses reveal network location and can be used to identify
  individuals or target infrastructure. While not directly PII in isolation, they
  can be correlated with other data for tracking or launching targeted attacks.
sensitivity_labels:
  pspf: OFFICIAL
  qgiscf: OFFICIAL
  qgiscf_dlm: OFFICIAL
  us_gov: Public
  uk_gov: OFFICIAL
  nz_gov: UNCLASSIFIED
  ca_gov: Unclassified
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-ip-address
  title: IP address entity definition - Microsoft Learn
created: '2026-02-08'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
