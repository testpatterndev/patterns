schema: testpattern/v1
name: X.509 Certificate Private Key
slug: global-x509-certificate-private-key
version: 1.0.0
type: regex
engine: universal
description: >-
  Detects X.509 certificate private key PEM headers. This is a broad pattern covering RSA, EC, PKCS#8, and OpenSSH
  private key formats. This pattern is based on a Microsoft Purview built-in sensitive information type. For more specific
  detection, see global-rsa-private, global-ec-private, global-pkcs8-private, and global-openssh-private.
operation: >-
  Matches PEM-encoded private key headers including RSA PRIVATE KEY, EC PRIVATE KEY, PRIVATE KEY (PKCS#8), OPENSSH
  PRIVATE KEY, and DSA PRIVATE KEY formats. Any private key in plaintext represents a critical security exposure.
  Corroborative evidence: 8 keywords within 300 characters. Keyword lists: credentials-api-keys.
pattern: -----BEGIN\s+(RSA\s+|EC\s+|OPENSSH\s+|DSA\s+|ENCRYPTED\s+)?PRIVATE\s+KEY-----
confidence: high
confidence_justification: >-
  High confidence: PEM private key headers are highly distinctive markers with minimal false positive risk. The BEGIN
  PRIVATE KEY format is a well-defined standard.
jurisdictions:
  - global
regulations:
  - general-data-protection
data_categories:
  - credentials
  - security
corroborative_evidence:
  keywords:
    - private key
    - certificate
    - X.509
    - PEM
    - key file
    - SSL
    - TLS
    - encryption
  proximity: 300
  keyword_lists:
    - credentials-api-keys
test_cases:
  should_match:
    - value: '-----BEGIN RSA PRIVATE KEY-----'
      description: RSA private key header
    - value: '-----BEGIN PRIVATE KEY-----'
      description: PKCS#8 private key header
    - value: '-----BEGIN EC PRIVATE KEY-----'
      description: EC private key header
  should_not_match:
    - value: '-----BEGIN PUBLIC KEY-----'
      description: Public key header, not private
    - value: '-----BEGIN CERTIFICATE-----'
      description: Certificate, not private key
false_positives:
  - description: >-
      Documentation and tutorials showing private key format examples without actual key material.
    mitigation: >-
      Check if the content following the header contains actual Base64-encoded key data.
  - description: >-
      Encrypted private keys (BEGIN ENCRYPTED PRIVATE KEY) that require a passphrase.
    mitigation: >-
      Still flag encrypted keys as they reveal the presence of key material and may be decryptable.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: specific
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
    - confidence_level: 85
      id_match: Regex_x509_private_key
      matches:
        - ref: Keyword_x509_private_key
  regexes:
    - id: Regex_x509_private_key
      pattern: -----BEGIN\s+(RSA\s+|EC\s+|OPENSSH\s+|DSA\s+|ENCRYPTED\s+)?PRIVATE\s+KEY-----
  keywords:
    - id: Keyword_x509_private_key
      groups:
        - match_style: word
          terms:
            - private key
            - certificate
            - X.509
            - PEM
            - key file
            - SSL
            - TLS
            - RSA
            - PKCS
            - encryption key
            - ssh key
            - id_rsa
risk_rating: 10
risk_description: >-
  Exposure of this credential could grant unauthorized access to cloud infrastructure, databases, or services. Compromised
  credentials are a leading cause of data breaches and can result in full system takeover.
sensitivity_labels:
  pspf: "PROTECTED"
  qgiscf: "PROTECTED"
  qgiscf_dlm: "PROTECTED"
  us_gov: "CUI Specified"
  uk_gov: "OFFICIAL-SENSITIVE"
  nz_gov: "RESTRICTED"
  ca_gov: "Protected B"
references:
  - url: https://learn.microsoft.com/en-us/purview/sit-defn-x509-certificate-private-key
    title: "X.509 certificate private key entity definition - Microsoft Learn"
created: '2026-02-09'
updated: '2026-02-09'
author: testpattern-community
source: microsoft
license: MIT
