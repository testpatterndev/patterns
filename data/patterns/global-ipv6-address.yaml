schema: testpattern/v1
name: IPv6
slug: global-ipv6-address
version: 1.0.0
type: regex
engine: universal
description: Detects IPv6 patterns. This pattern is based on a Microsoft Purview built-in
  sensitive information type. Users already running Purview may prefer to enable the
  built-in SIT directly, or use this version as a starting point for customisation.
operation: 'Reference: https://datatracker.ietf.org/doc/html/rfc4291 Corroborative
  evidence: 5 keywords within 300 characters. Keyword lists: pii-contact. Uses additional
  domain-context evidence and explicit exclusion logic for template/sample/test text.'
pattern: \b(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\b
confidence: high
confidence_justification: 'High confidence: structurally constrained pattern with
  corroborative keyword support reduces false positive rates significantly. Added
  context gating and exclusion rules improve precision and reduce incidental matches.'
jurisdictions:
- global
regulations:
- general-data-protection
data_categories:
- network
- pii
corroborative_evidence:
  keywords:
  - IP address
  - IP
  - network
  - host
  - server
  proximity: 300
  keyword_lists:
  - pii-contact
test_cases:
  should_match:
  - value: 2001:0db8:85a3:0000:0000:8a2e:0370:7334
    description: Full IPv6 address
  - value: fe80:0000:0000:0000:0000:0000:0000:0001
    description: Link-local IPv6
  - value: 2001:0db8:0000:0000:0000:0000:0000:0001
    description: Documentation IPv6
  should_not_match:
  - value: 2001:0db8:85a3:0000:0000:8a2e:0370
    description: Only 7 groups instead of 8
  - value: ZZZZ:0db8:85a3:0000:0000:8a2e:0370:7334
    description: Contains invalid hex characters (Z)
  - value: 2001:0db8:85a3:00000:0000:8a2e:0370:7334
    description: Group exceeds 4 hex digits (5 digits in fourth group)
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Common words and phrases related to ipv6 appearing in policy documents,
    training materials, HR templates, or compliance guidelines without actual personal
    data.
  mitigation: Require corroborative evidence keywords within the proximity window
    to confirm sensitive data context rather than general discussion.
- description: In English (as the primary international business language), similar
    terminology used in formal or administrative contexts (education, professional
    documentation) that does not constitute sensitive data collection.
  mitigation: Layer with additional contextual signals such as structured identifiers,
    form fields, or database column headers to distinguish sensitive records from
    general references.
- description: High-frequency pattern matches in large document corpora due to broad
    regex anchors. Expected match rate is significantly higher than specific identifier
    patterns.
  mitigation: Tune confidence thresholds for bulk scanning. Consider using this pattern
    primarily as a pre-filter with secondary validation.
exports:
- purview_xml
- yaml
- regex_copy
scope: wide
purview:
  patterns_proximity: 300
  recommended_confidence: 75
  pattern_tiers:
  - confidence_level: 80
    id_match: Regex_ipv6_address
    matches:
    - ref: Pattern_global_ipv6_address_label_context
    - ref: Keyword_global_ipv6_address_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_ipv6_address_noise_exclusion
  - confidence_level: 75
    id_match: Regex_ipv6_address
    matches:
    - ref: Keyword_ipv6_address
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_ipv6_address_noise_exclusion
  - confidence_level: 65
    id_match: Regex_ipv6_address
    matches:
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_ipv6_address_noise_exclusion
  regexes:
  - id: Regex_ipv6_address
    pattern: \b(?:[0-9A-Fa-f]{1,4}:){7}[0-9A-Fa-f]{1,4}\b
  - id: Pattern_global_ipv6_address_label_context
    pattern: (?i)\\b(?:ipv6|address)\\b
  keywords:
  - id: Keyword_ipv6_address
    groups:
    - match_style: word
      terms:
      - IP address
      - IPv6
      - IP
      - network address
      - host address
      - server address
      - subnet
      - gateway
      - DHCP
      - DNS
      - firewall
      - router
  - id: Keyword_global_ipv6_address_domain_context
    groups:
    - match_style: word
      terms:
      - ipv6
      - address
      - field
      - identifier
      - reference
  - id: Keyword_global_ipv6_address_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 4
risk_description: IP addresses reveal network location and can be used to identify
  individuals or target infrastructure. While not directly PII in isolation, they
  can be correlated with other data for tracking or launching targeted attacks.
sensitivity_labels:
  pspf: OFFICIAL
  qgiscf: OFFICIAL
  qgiscf_dlm: OFFICIAL
  us_gov: Public
  uk_gov: OFFICIAL
  nz_gov: UNCLASSIFIED
  ca_gov: Unclassified
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-ip-address
  title: IP address entity definition - Microsoft Learn
created: '2026-02-08'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
