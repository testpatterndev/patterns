schema: testpattern/v1
name: Unique Taxpayer Reference
slug: uk-unique-taxpayer-reference
version: 1.0.0
type: regex
engine: universal
description: >-
  Detects Unique Taxpayer Reference patterns. This pattern is based on a Microsoft Purview built-in sensitive information type. Users already running Purview may prefer to enable the built-in SIT directly, or use this version as a starting point for customisation.
operation: >-
  Validation: Mod 11. Reference: https://design.tax.service.gov.uk/hmrc-design-patterns/unique-taxpayer-reference/
  Corroborative evidence: 3 keywords within 300 characters. Keyword lists: pii-government-id, financial-transaction.
pattern: \b\d{10}\b
confidence: medium
confidence_justification: >-
  Medium confidence: pattern has structural constraints but corroborative keywords are recommended to reduce false
  positive rates.
jurisdictions:
  - uk
regulations:
  - uk-dpa-2018
data_categories:
  - pii
  - government-id
corroborative_evidence:
  keywords:
    - identifier
    - number
    - ID
  proximity: 300
  keyword_lists:
    - pii-government-id
    - financial-transaction
test_cases:
  should_match:
    - value: '1234567890'
      description: Standard 10-digit UTR
    - value: '9876543210'
      description: Alternate UTR
    - value: '0123456789'
      description: Zero-leading UTR
  should_not_match:
    - value: 123456789
      description: Only 9 digits instead of 10
    - value: 12345678901
      description: 11 digits instead of 10
    - value: 123456789A
      description: Contains a letter instead of all digits
false_positives:
  - description: >-
      Long numeric sequences in unrelated contexts (tracking numbers, serial codes) matching the Unique Taxpayer
      Reference format
    mitigation: Use corroborative keywords and, where available, checksum validation to filter false matches.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: narrow
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
    - confidence_level: 85
      id_match: Regex_uk_utr
      matches:
        - ref: Keyword_uk_utr_specific
    - confidence_level: 75
      id_match: Regex_uk_utr
      matches:
        - ref: Keyword_uk_utr_broad
    - confidence_level: 65
      id_match: Regex_uk_utr
  regexes:
    - id: Regex_uk_utr
      pattern: \b\d{10}\b
  keywords:
    - id: Keyword_uk_utr_specific
      groups:
        - match_style: word
          terms:
            - unique taxpayer reference
            - UTR
            - taxpayer reference
            - tax reference number
            - self assessment
            - SA reference
            - HMRC reference
            - unique taxpayer
    - id: Keyword_uk_utr_broad
      groups:
        - match_style: word
          terms:
            - HMRC
            - tax return
            - tax office
            - inland revenue
            - corporation tax
            - income tax
            - self-employment
            - partnership tax
  filters:
    - id: Filter_uk_utr_same_digits
      type: AllDigitsSameFilter
risk_rating: 5
risk_description: >-
  This sensitive information type identifies data that could be misused if exposed to unauthorized parties. Proper
  classification and protection are required to prevent data breaches and comply with applicable regulations.
sensitivity_labels:
  pspf: "OFFICIAL: Sensitive"
  qgiscf: "SENSITIVE"
  qgiscf_dlm: "SENSITIVE"
references:
  - url: https://learn.microsoft.com/en-us/purview/sit-defn-uk-unique-taxpayer-reference-number
    title: "U.K. Unique Taxpayer Reference Number entity definition - Microsoft Learn"
created: '2026-02-08'
updated: '2026-02-09'
author: testpattern-community
source: microsoft
license: MIT
