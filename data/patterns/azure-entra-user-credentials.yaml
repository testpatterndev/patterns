schema: testpattern/v1
name: Microsoft Entra User Credentials
slug: azure-entra-user-credentials
version: 1.0.0
type: regex
engine: universal
description: >-
  Detects Microsoft Entra (formerly Azure AD) user credential patterns including username/password combinations targeting
  Microsoft login endpoints. This pattern is based on a Microsoft Purview built-in sensitive information type. Users
  already running Purview may prefer to enable the built-in SIT directly, or use this version as a starting point for
  customisation.
operation: >-
  Matches user credential patterns that include Microsoft Entra usernames (typically email format with onmicrosoft.com
  or custom domain) combined with password values in code, configuration, or documents. Corroborative evidence: 8
  keywords within 300 characters. Keyword lists: credentials-passwords.
pattern: (?i)(username|user[._-]?id|upn)\s*[:=]\s*"?[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.(onmicrosoft\.com|com|org|net)"?\s*[;,\n]\s*(password|pwd)\s*[:=]\s*"?[^\s"';,]{6,}"?
confidence: high
confidence_justification: >-
  High confidence: email-format username combined with password assignment and Microsoft domain context provides strong
  structural constraint.
jurisdictions:
  - global
regulations:
  - general-data-protection
data_categories:
  - credentials
  - security
corroborative_evidence:
  keywords:
    - Entra
    - Azure AD
    - onmicrosoft.com
    - login.microsoftonline.com
    - user credentials
    - username
    - password
    - Microsoft 365
  proximity: 300
  keyword_lists:
    - credentials-passwords
test_cases:
  should_match:
    - value: "username=admin@contoso.onmicrosoft.com;password=P@ssw0rd123"
      description: Entra user credentials with onmicrosoft.com domain
    - value: "user_id=\"user@example.com\"\npassword=\"TestS3cret\""
      description: User credentials in config format
    - value: "upn=test@contoso.com,pwd=000000000000"
      description: UPN with password placeholder
  should_not_match:
    - value: username=admin@contoso.onmicrosoft.com
      description: Username without password
    - value: The user must enter their password to log in
      description: Documentation text, not actual credentials
false_positives:
  - description: >-
      Microsoft identity documentation with example user credentials.
    mitigation: >-
      Check for common example domains (contoso.com, example.com) and placeholder passwords.
  - description: >-
      Automated test scripts with test account credentials.
    mitigation: >-
      Flag for review since test credentials may still provide access to test environments.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: specific
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
    - confidence_level: 85
      id_match: Regex_azure_entra_user_credentials
      matches:
        - ref: Keyword_azure_entra_user_creds
  regexes:
    - id: Regex_azure_entra_user_credentials
      pattern: (?i)(username|user[._-]?id|upn)\s*[:=]\s*"?[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.(onmicrosoft\.com|com|org|net)"?\s*[;,\n]\s*(password|pwd)\s*[:=]\s*"?[^\s"';,]{6,}"?
  keywords:
    - id: Keyword_azure_entra_user_creds
      groups:
        - match_style: word
          terms:
            - Entra
            - Azure AD
            - onmicrosoft.com
            - login.microsoftonline.com
            - user credentials
            - username
            - password
            - Microsoft 365
            - sign-in
            - user principal name
            - tenant
            - authentication
risk_rating: 10
risk_description: >-
  Exposure of this credential could grant unauthorized access to cloud infrastructure, databases, or services. Compromised
  credentials are a leading cause of data breaches and can result in full system takeover.
sensitivity_labels:
  pspf: "PROTECTED"
  qgiscf: "PROTECTED"
  qgiscf_dlm: "PROTECTED"
references:
  - url: https://learn.microsoft.com/en-us/purview/sit-defn-azure-ad-user-credentials
    title: "Microsoft Entra user credentials entity definition - Microsoft Learn"
created: '2026-02-09'
updated: '2026-02-09'
author: testpattern-community
source: microsoft
license: MIT
