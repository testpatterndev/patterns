schema: testpattern/v1
name: Henkilötunnus (HETU)
slug: fi-national-id
version: 1.0.0
type: regex
engine: universal
description: Detects Henkilötunnus (HETU) patterns. This pattern is based on a Microsoft
  Purview built-in sensitive information type. Users already running Purview may prefer
  to enable the built-in SIT directly, or use this version as a starting point for
  customisation.
operation: 'Reference: https://learn.microsoft.com/en-us/purview/sit-defn-finland-national-id
  Corroborative evidence: 3 keywords within 300 characters. Keyword lists: pii-civic-credentials.
  Uses additional domain-context evidence and explicit exclusion logic for template/sample/test
  text.'
pattern: \b\d{6}[-+A]\d{3}[A-Z0-9]\b
confidence: high
confidence_justification: 'High confidence: pattern has strong structural constraints
  (specific format, prefix, or character class restrictions) that significantly reduce
  false positive rates. Added context gating and exclusion rules improve precision
  and reduce incidental matches.'
jurisdictions:
- eu
- fi
regulations:
- gdpr
data_categories:
- pii
- government-id
corroborative_evidence:
  keywords:
  - henkilötunnus
  - HETU
  - personal identity code
  proximity: 300
  keyword_lists:
  - pii-civic-credentials
test_cases:
  should_match:
  - value: 010175-123A
    description: Finnish HETU born in 1900s
  - value: 120388+234B
    description: Finnish HETU born in 1800s
  - value: 150392A456C
    description: Finnish HETU born in 2000s
  should_not_match:
  - value: 010175X123A
    description: Invalid century character
  - value: 010175-12A
    description: Too few digits in individual number
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: The structured format with century marker significantly reduces false
    positives, though test data or documentation may contain example patterns.
  mitigation: The century marker (-, +, A) provides strong structural validation.
    Additional keyword context improves accuracy.
- description: In multiple languages, similar terminology used in formal or administrative
    contexts (education, professional documentation) that does not constitute sensitive
    data collection.
  mitigation: Layer with additional contextual signals such as structured identifiers,
    form fields, or database column headers to distinguish sensitive records from
    general references.
exports:
- purview_xml
- yaml
- regex_copy
scope: narrow
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
  - confidence_level: 90
    id_match: Regex_fi_national_id
    matches:
    - ref: Pattern_fi_national_id_label_context
    - ref: Keyword_fi_national_id_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_fi_national_id_noise_exclusion
  - confidence_level: 85
    id_match: Regex_fi_national_id
    matches:
    - ref: Keyword_fi_national_id
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_fi_national_id_noise_exclusion
  - confidence_level: 75
    id_match: Regex_fi_national_id
    matches:
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_fi_national_id_noise_exclusion
  regexes:
  - id: Regex_fi_national_id
    pattern: \b\d{6}[-+A]\d{3}[A-Z0-9]\b
  - id: Pattern_fi_national_id_label_context
    pattern: (?i)\\b(?:henkilötunnus\\s+\(hetu\)|henkil|tunnus|hetu|national)\\b
  keywords:
  - id: Keyword_fi_national_id
    groups:
    - match_style: word
      terms:
      - henkilötunnus
      - HETU
      - personal identity code
      - sosiaaliturvatunnus
      - tunnistenumero
      - henkilönumero
      - personbeteckning
      - personnummer
      - Finnish personal ID
      - national identification
  - id: Keyword_fi_national_id_domain_context
    groups:
    - match_style: word
      terms:
      - henkilötunnus (hetu)
      - henkil
      - tunnus
      - hetu
      - national
      - field
      - identifier
      - reference
  - id: Keyword_fi_national_id_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 9
risk_description: This identifier uniquely links to an individual and is a primary
  target for identity theft and fraud. Exposure can lead to unauthorized financial
  activity, impersonation, and significant personal harm.
sensitivity_labels:
  pspf: PROTECTED
  qgiscf: PROTECTED
  qgiscf_dlm: PROTECTED
  us_gov: CUI
  uk_gov: OFFICIAL-SENSITIVE
  nz_gov: RESTRICTED
  ca_gov: Protected B
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-finland-national-id
  title: Finland National ID entity definition - Microsoft Learn
created: '2026-02-09'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
