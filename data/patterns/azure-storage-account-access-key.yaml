schema: testpattern/v1
name: Azure Storage Account Access Key
slug: azure-storage-account-access-key
version: 1.0.0
type: regex
engine: universal
description: Detects Azure Storage account access key patterns in connection strings.
  This pattern is based on a Microsoft Purview built-in sensitive information type.
  Users already running Purview may prefer to enable the built-in SIT directly, or
  use this version as a starting point for customisation.
operation: 'Matches Azure Storage account connection strings containing DefaultEndpointsProtocol,
  AccountName, and AccountKey parameters. The AccountKey is an 88-character Base64-encoded
  string. Corroborative evidence: 8 keywords within 300 characters. Keyword lists:
  credentials-api-keys. Uses additional domain-context evidence and explicit exclusion
  logic for template/sample/test text.'
pattern: DefaultEndpointsProtocol=https?;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/\s]{86,92}={0,2}
confidence: high
confidence_justification: 'High confidence: DefaultEndpointsProtocol prefix combined
  with AccountKey of exactly 88 Base64 characters is structurally unique to Azure
  Storage connection strings. Added context gating and exclusion rules improve precision
  and reduce incidental matches.'
jurisdictions:
- global
regulations:
- general-data-protection
data_categories:
- credentials
- security
corroborative_evidence:
  keywords:
  - Azure Storage
  - storage account
  - AccountKey
  - AccountName
  - DefaultEndpointsProtocol
  - blob
  - container
  - connection string
  proximity: 300
  keyword_lists:
  - credentials-api-keys
test_cases:
  should_match:
  - value: DefaultEndpointsProtocol=https;AccountName=myaccount;AccountKey=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==
    description: Azure Storage connection string with 88-char key
  - value: DefaultEndpointsProtocol=http;AccountName=devstoreaccount1;AccountKey=00000000000000000000000000000000000000000000000000000000000000000000000000000000000000==
    description: Storage emulator connection string
  - value: DefaultEndpointsProtocol=https;AccountName=prodstore;AccountKey=ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/ABCDEFGHIJKLMNOPQRSTUV==
    description: Storage connection with mixed case key
  should_not_match:
  - value: DefaultEndpointsProtocol=https;AccountName=myaccount
    description: Storage connection without AccountKey
  - value: AccountKey=shortkey
    description: Account key too short to be valid
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Azure Storage documentation with placeholder connection strings and
    example keys.
  mitigation: Check for the well-known development storage emulator key and documentation
    patterns.
- description: Azurite local storage emulator using the well-known development account
    key.
  mitigation: Exclude the known Azurite/development storage emulator key value.
exports:
- purview_xml
- yaml
- regex_copy
scope: specific
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
  - confidence_level: 90
    id_match: Regex_azure_storage_account_access_key
    matches:
    - ref: Pattern_azure_storage_account_access_key_label_context
    - ref: Keyword_azure_storage_account_access_key_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_azure_storage_account_access_key_noise_exclusion
  - confidence_level: 85
    id_match: Regex_azure_storage_account_access_key
    matches:
    - ref: Keyword_azure_storage_access_key
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_azure_storage_account_access_key_noise_exclusion
  regexes:
  - id: Regex_azure_storage_account_access_key
    pattern: DefaultEndpointsProtocol=https?;AccountName=[^;]+;AccountKey=[A-Za-z0-9+/\s]{86,92}={0,2}
  - id: Pattern_azure_storage_account_access_key_label_context
    pattern: (?i)\\b(?:azure\\s+storage\\s+account\\s+access\\s+key|azure|storage|account|access|key)\\b
  keywords:
  - id: Keyword_azure_storage_access_key
    groups:
    - match_style: word
      terms:
      - Azure Storage
      - storage account
      - AccountKey
      - AccountName
      - DefaultEndpointsProtocol
      - blob
      - container
      - connection string
      - core.windows.net
      - primary key
      - secondary key
  - id: Keyword_azure_storage_account_access_key_domain_context
    groups:
    - match_style: word
      terms:
      - azure storage account access key
      - azure
      - storage
      - account
      - access
      - key
      - field
      - identifier
      - reference
  - id: Keyword_azure_storage_account_access_key_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 10
risk_description: Exposure of this credential could grant unauthorized access to cloud
  infrastructure, databases, or services. Compromised credentials are a leading cause
  of data breaches and can result in full system takeover.
sensitivity_labels:
  pspf: PROTECTED
  qgiscf: PROTECTED
  qgiscf_dlm: PROTECTED
  us_gov: CUI Specified
  uk_gov: OFFICIAL-SENSITIVE
  nz_gov: RESTRICTED
  ca_gov: Protected B
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-azure-storage-account-access-key
  title: Azure Storage account access key entity definition - Microsoft Learn
created: '2026-02-09'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
