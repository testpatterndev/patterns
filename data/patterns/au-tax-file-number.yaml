schema: testpattern/v1
name: Australian Tax File Number
slug: au-tax-file-number
version: 1.0.0
type: regex
engine: boost_regex
description: >-
  Detects Australian Tax File Numbers (TFNs), which are unique nine-digit identifiers issued by the Australian Taxation
  Office to individuals and organisations for tax and superannuation purposes. TFNs are commonly formatted as three
  groups of three digits separated by spaces or hyphens. Due to the generic nine-digit format, corroborative evidence is
  essential for reliable detection.
operation: >-
  Validation: Mod 11 with weights [1,4,3,7,5,8,6,9,10]. Reference: https://clearwater.com.au/code/tfn,
  https://github.com/steveswinsburg/tfn-validator,
  https://learn.microsoft.com/en-us/purview/sit-defn-australia-tax-file-number Corroborative evidence: 5 keywords within
  300 characters. Keyword lists: au-identity-tfn, pii-government-id.
pattern: \b\d{3}[\s-]?\d{3}[\s-]?\d{3}\b
confidence: high
confidence_justification: >-
  High confidence when corroborative evidence keywords are present. The nine-digit format alone is common and ambiguous,
  but when combined with proximity keywords such as "tax file number" or "TFN", the pattern reliably identifies
  Australian Tax File Numbers. The ATO uses a weighted check digit algorithm, but this regex does not validate it;
  corroborative evidence compensates for the lack of algorithmic validation.
jurisdictions:
  - au
regulations:
  - privacy-act-1988
  - taxation-administration-act-1953
data_categories:
  - pii
  - financial
  - government-id
corroborative_evidence:
  keywords:
    - tax file number
    - TFN
    - tax file no
    - australian tax
    - taxfile
  proximity: 300
  keyword_lists:
    - au-identity-tfn
    - pii-government-id
test_cases:
  should_match:
    - value: 123 456 789
      description: Standard spaced format (3-3-3 grouping)
    - value: 123-456-789
      description: Hyphen-separated format (3-3-3 grouping)
    - value: '123456789'
      description: Continuous digits without separators
  should_not_match:
    - value: 12 345 678
      description: Only 8 digits in a 2-3-3 grouping, not a valid TFN structure
    - value: '1234567890'
      description: 10 digits without separators, exceeds the 9-digit TFN length
false_positives:
  - description: Generic nine-digit numbers such as reference codes, invoice numbers, or account identifiers
    mitigation: >-
      Require corroborative evidence keywords within the proximity window. Without keywords like 'TFN' or 'tax file
      number' nearby, suppress the match.
  - description: Phone numbers formatted as nine consecutive digits
    mitigation: >-
      Use corroborative evidence to distinguish tax contexts from telecommunications contexts. Consider layering with
      phone number detection to deprioritise overlapping matches.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: narrow
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
    - confidence_level: 85
      id_match: Regex_au_tfn
      matches:
        - ref: Keyword_au_tfn_specific
    - confidence_level: 75
      id_match: Regex_au_tfn
      matches:
        - ref: Keyword_au_tfn_broad
    - confidence_level: 65
      id_match: Regex_au_tfn
  regexes:
    - id: Regex_au_tfn
      pattern: \b\d{3}[\s-]?\d{3}[\s-]?\d{3}\b
      validators:
        - ref: Func_australian_tax_file_number
  keywords:
    - id: Keyword_au_tfn_specific
      groups:
        - match_style: word
          terms:
            - tax file number
            - TFN
            - tax file no
            - tax file no.
            - T.F.N.
            - taxfile
            - tax file
            - tax number
    - id: Keyword_au_tfn_broad
      groups:
        - match_style: word
          terms:
            - australian tax
            - Australian Taxation Office
            - ATO
            - superannuation
            - tax return
            - tax declaration
            - income tax
            - tax agent
            - myGov
  filters:
    - id: Filter_au_tfn_same_digits
      type: AllDigitsSameFilter
    - id: Filter_au_tfn_exclude_test
      type: TextMatchFilter
      direction: Full
      logic: Exclude
      terms:
        - "000000000"
        - "000 000 000"
        - "123456789"
        - "123 456 789"
risk_rating: 9
risk_description: >-
  Tax file number exposure enables identity fraud and unauthorised tax lodgements under Privacy Act 1988
sensitivity_labels:
  pspf: "OFFICIAL: Sensitive"
  qgiscf: "SENSITIVE"
  qgiscf_dlm: "SENSITIVE Personal-Privacy"
created: '2026-02-08'
updated: '2026-02-09'
author: testpattern-community
license: MIT
