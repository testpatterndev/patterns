schema: testpattern/v1
name: New Zealand Social Welfare Number
slug: nz-social-welfare-number
version: 1.0.0
type: regex
engine: universal
description: Detects New Zealand Social Welfare Number patterns. This pattern is based
  on a Microsoft Purview built-in sensitive information type. Due to the generic numeric
  format, corroborative evidence keywords are essential for reliable detection.
operation: 'Corroborative evidence: 5 keywords within 300 characters. Keyword lists:
  social-welfare, nz-government. Adds label-context matching and exclusion logic for
  sample/template/test placeholders. Uses additional domain-context evidence and explicit
  exclusion logic for template/sample/test text.'
pattern: \b\d{9}\b
confidence: medium
confidence_justification: 'Medium confidence: nine-digit numbers are common in many
  contexts. Keywords such as ''social welfare'' or ''MSD'' are required for reliable
  detection. Context label evidence plus explicit template/example exclusion improves
  precision for high-risk identifiers. Added context gating and exclusion rules improve
  precision and reduce incidental matches.'
jurisdictions:
- nz
regulations:
- privacy-act-2020
- social-security-act-2018
data_categories:
- pii
- government-id
corroborative_evidence:
  keywords:
  - social welfare
  - MSD
  - beneficiary
  - welfare number
  - client number
  proximity: 300
  keyword_lists:
  - social-welfare
  - nz-government
test_cases:
  should_match:
  - value: '123456789'
    description: Nine-digit social welfare number format
  - value: '987654321'
    description: Nine-digit MSD client number
  - value: '112233445'
    description: Nine-digit beneficiary identifier
  should_not_match:
  - value: '12345678'
    description: Eight digits, too short for welfare number
  - value: '1234567890'
    description: Ten digits, exceeds welfare number format
  - value: sample template placeholder number 123456789
    description: Template/sample context should be excluded even when numeric-like
      values appear
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Generic numeric sequences matching the digit pattern in non-health
    contexts
  mitigation: Require corroborative evidence keywords within the proximity window
    to distinguish health identifiers from general numeric data.
- description: Reference numbers or account identifiers from other domains with similar
    digit counts
  mitigation: Layer with document classification to prioritise matches in health and
    medical documents.
exports:
- purview_xml
- yaml
- regex_copy
scope: narrow
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
  - confidence_level: 95
    id_match: Regex_nz_social_welfare
    matches:
    - ref: Pattern_nz_social_welfare_number_label_context
    - ref: Keyword_nz_social_welfare_number_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_nz_social_welfare_number_noise_exclusion
  - confidence_level: 90
    id_match: Regex_nz_social_welfare
    matches:
    - ref: Pattern_nz_social_welfare_number_label_context
    - ref: Keyword_nz_social_welfare
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_nz_social_welfare_number_noise_exclusion
  - confidence_level: 85
    id_match: Regex_nz_social_welfare
    matches:
    - ref: Keyword_nz_social_welfare
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_nz_social_welfare_number_noise_exclusion
  - confidence_level: 75
    id_match: Regex_nz_social_welfare
    matches:
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_nz_social_welfare_number_noise_exclusion
  regexes:
  - id: Regex_nz_social_welfare
    pattern: \b\d{9}\b
  - id: Pattern_nz_social_welfare_number_label_context
    pattern: (?i)\\b(?:new|zealand|social|welfare|health\\s+number|insurance\\s+number|patient\\s+identifier|social\\s+welfare)\\b
  keywords:
  - id: Keyword_nz_social_welfare
    groups:
    - match_style: word
      terms:
      - social welfare
      - MSD
      - beneficiary
      - welfare number
      - client number
      - Ministry of Social Development
      - benefit number
      - welfare client
      - social security
      - Work and Income
      - WINZ
      - benefit recipient
  - id: Keyword_nz_social_welfare_number_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
  - id: Keyword_nz_social_welfare_number_domain_context
    groups:
    - match_style: word
      terms:
      - new zealand social welfare number
      - new
      - zealand
      - social
      - welfare
      - field
      - identifier
      - reference
  filters:
  - id: Filter_nz_social_welfare_same_digits
    type: AllDigitsSameFilter
risk_rating: 8
risk_description: Health and medical information is among the most sensitive personal
  data under privacy laws globally. Unauthorized disclosure can result in discrimination,
  personal harm, and regulatory penalties under health privacy frameworks.
sensitivity_labels:
  pspf: 'OFFICIAL: Sensitive'
  qgiscf: SENSITIVE
  qgiscf_dlm: SENSITIVE Personal-Privacy
  us_gov: CUI
  uk_gov: OFFICIAL-SENSITIVE
  nz_gov: RESTRICTED
  ca_gov: Protected B
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-new-zealand-social-welfare-number
  title: New Zealand Social Welfare Number entity definition - Microsoft Learn
created: '2026-02-09'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
