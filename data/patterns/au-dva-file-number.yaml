schema: testpattern/v1
name: DVA File Number
slug: au-dva-file-number
version: 1.0.0
type: regex
engine: universal
description: >-
  Detects Department of Veterans' Affairs (DVA) file numbers used to identify Australian veterans and eligible
  dependants for health and support services.
operation: >-
  Matches a DVA file number consisting of a state letter (N, V, Q, S, W, A, T, D) optionally followed by a card-type
  letter, then 5-7 digits. Corroborative evidence: 19 keywords within 300 characters.
pattern: \b[NVQSWATD][XKVGTASBM]?\d{5,7}\b
confidence: medium
confidence_justification: >-
  Medium confidence: the format is relatively short and state-letter prefixes could match other identifiers.
  Corroborative keywords improve accuracy.
jurisdictions:
  - au
regulations:
  - privacy-act-1988
  - veterans-entitlements-act-1986
data_categories:
  - government-id
  - pii
corroborative_evidence:
  keywords:
    - DVA
    - Department of Veterans Affairs
    - Veterans Affairs
    - veteran
    - veterans
    - ex-service
    - ex service
    - defence service
    - defense service
    - war widow
    - war widower
    - TPI
    - totally and permanently incapacitated
    - gold card
    - white card
    - DVA card
    - DVA file
    - DVA number
    - repatriation
  proximity: 300
test_cases:
  should_match:
    - value: 'DVA file number: NX1234567'
      description: NSW DVA file number with card type
    - value: Veteran DVA card QA12345
      description: QLD DVA file number
    - value: 'Department of Veterans Affairs reference: V123456'
      description: VIC DVA file number
  should_not_match:
    - value: B1234567
      description: Prefix letter B is not in valid DVA state set (NVQSWATD)
    - value: NX12
      description: Too few digits after prefix letters
false_positives:
  - description: State-prefixed reference codes in non-DVA contexts may match the pattern.
    mitigation: Require corroborative keywords such as DVA, veteran, or defence service within proximity.
exports:
  - purview_xml
  - yaml
  - regex_copy
scope: narrow
risk_rating: 8
risk_description: DVA file number exposure enables veterans affairs fraud and access to service records.
sensitivity_labels:
  pspf: 'OFFICIAL: Sensitive'
  qgiscf: SENSITIVE
  qgiscf_dlm: SENSITIVE Personal-Privacy
  us_gov: "CUI"
  uk_gov: "OFFICIAL-SENSITIVE"
  nz_gov: "RESTRICTED"
  ca_gov: "Protected B"
purview:
  patterns_proximity: 300
  recommended_confidence: 85
  pattern_tiers:
    - confidence_level: 95
      id_match: Regex_dva_file
      matches:
        - ref: Keyword_dva
    - confidence_level: 85
      id_match: Regex_dva_file
      matches:
        - ref: Keyword_veteran
    - confidence_level: 75
      id_match: Regex_dva_file
      matches:
        - ref: Keyword_defence
  regexes:
    - id: Regex_dva_file
      pattern: \b[NVQSWATD][XKVGTASBM]?\d{5,7}\b
  keywords:
    - id: Keyword_dva
      groups:
        - match_style: word
          terms:
            - DVA
            - Department of Veterans Affairs
            - Veterans Affairs
            - veteran
            - veterans
            - ex-service
            - ex service
            - defence service
            - defense service
            - war widow
            - war widower
            - TPI
            - totally and permanently incapacitated
            - gold card
            - white card
            - DVA card
            - DVA file
            - DVA number
            - repatriation
    - id: Keyword_veteran
      groups:
        - match_style: word
          terms:
            - veteran
            - veterans
            - ex-service
            - ex service
            - returned service
            - RSL
            - returned serviceman
            - returned servicewoman
            - war service
            - military service
            - ADF
            - Australian Defence Force
            - defence member
            - defense member
    - id: Keyword_defence
      groups:
        - match_style: word
          terms:
            - defence
            - defense
            - military
            - army
            - navy
            - air force
            - RAAF
            - RAN
            - ADF
            - soldier
            - sailor
            - airman
            - officer
            - enlisted
            - regiment
            - battalion
            - squadron
created: '2026-02-09'
updated: '2026-02-09'
author: testpattern-community
license: MIT
