schema: testpattern/v1
name: International Classification of Diseases (ICD-9-CM)
slug: global-icd-9-cm
version: 1.0.0
type: regex
engine: universal
description: Detects International Classification of Diseases (ICD-9-CM) patterns.
  This pattern is based on a Microsoft Purview built-in sensitive information type.
  Due to the generic numeric format, corroborative evidence keywords are essential
  for reliable detection.
operation: 'Corroborative evidence: 5 keywords within 300 characters. Keyword lists:
  icd-9, diagnosis-codes. Uses additional domain-context evidence and explicit exclusion
  logic for template/sample/test text.'
pattern: \b\d{3}\.?\d{0,2}\b
confidence: low
confidence_justification: 'Low confidence: three-digit numbers with optional decimal
  are extremely common in non-medical contexts. Corroborative evidence such as ''ICD-9''
  or ''diagnosis code'' is essential for accurate detection. Added context gating
  and exclusion rules improve precision and reduce incidental matches.'
jurisdictions:
- global
regulations:
- hipaa
- gdpr
data_categories:
- phi
- health
corroborative_evidence:
  keywords:
  - ICD-9
  - diagnosis code
  - diagnostic code
  - ICD code
  - medical classification
  proximity: 300
  keyword_lists:
  - icd-9
  - diagnosis-codes
test_cases:
  should_match:
  - value: '250.00'
    description: ICD-9 code for diabetes mellitus type II
  - value: '401.9'
    description: ICD-9 code for unspecified essential hypertension
  - value: '486'
    description: ICD-9 code for pneumonia
  should_not_match:
  - value: ABC.12
    description: Contains letters, not a valid ICD-9 code
  - value: AB.12
    description: Contains letters, not a valid ICD-9 format
  - value: template example placeholder record identifier
    description: Template/sample context should be excluded even when anchor words
      are present
false_positives:
- description: Generic numeric sequences matching the digit pattern in non-health
    contexts
  mitigation: Require corroborative evidence keywords within the proximity window
    to distinguish health identifiers from general numeric data.
- description: Reference numbers or account identifiers from other domains with similar
    digit counts
  mitigation: Layer with document classification to prioritise matches in health and
    medical documents.
exports:
- purview_xml
- yaml
- regex_copy
scope: narrow
purview:
  patterns_proximity: 300
  recommended_confidence: 75
  pattern_tiers:
  - confidence_level: 80
    id_match: Regex_icd_9_cm
    matches:
    - ref: Pattern_global_icd_9_cm_label_context
    - ref: Keyword_global_icd_9_cm_domain_context
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_icd_9_cm_noise_exclusion
  - confidence_level: 75
    id_match: Regex_icd_9_cm
    matches:
    - ref: Keyword_icd_9_cm
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_icd_9_cm_noise_exclusion
  - confidence_level: 65
    id_match: Regex_icd_9_cm
    matches:
    - type: any
      min_matches: 0
      max_matches: 0
      refs:
      - Keyword_global_icd_9_cm_noise_exclusion
  regexes:
  - id: Regex_icd_9_cm
    pattern: \b\d{3}\.?\d{0,2}\b
  - id: Pattern_global_icd_9_cm_label_context
    pattern: (?i)\\b(?:international\\s+classification\\s+of\\s+diseases\\s+\(icd\-9\-cm\)|classification|diseases|icd)\\b
  keywords:
  - id: Keyword_icd_9_cm
    groups:
    - match_style: word
      terms:
      - ICD-9
      - ICD-9-CM
      - diagnosis code
      - diagnostic code
      - ICD code
      - medical classification
      - MRN
      - medical record number
      - patient ID
      - clinical diagnosis
      - discharge diagnosis
      - admitting diagnosis
  - id: Keyword_global_icd_9_cm_domain_context
    groups:
    - match_style: word
      terms:
      - international classification of diseases (icd-9-cm)
      - classification
      - diseases
      - icd
      - field
      - identifier
      - reference
  - id: Keyword_global_icd_9_cm_noise_exclusion
    groups:
    - match_style: word
      terms:
      - sample
      - template
      - example
      - dummy
      - test data
      - training data
      - placeholder
      - mock
      - boilerplate
risk_rating: 8
risk_description: Health and medical information is among the most sensitive personal
  data under privacy laws globally. Unauthorized disclosure can result in discrimination,
  personal harm, and regulatory penalties under health privacy frameworks.
sensitivity_labels:
  pspf: 'OFFICIAL: Sensitive'
  qgiscf: SENSITIVE
  qgiscf_dlm: SENSITIVE Personal-Privacy
  us_gov: CUI Specified
  uk_gov: OFFICIAL-SENSITIVE
  nz_gov: CONFIDENTIAL
  ca_gov: Protected B
references:
- url: https://learn.microsoft.com/en-us/purview/sit-defn-international-classification-of-diseases-icd-9-cm
  title: International Classification of Diseases (ICD-9-CM) entity definition - Microsoft
    Learn
created: '2026-02-09'
updated: '2026-02-12'
author: testpattern-community
source: microsoft
license: MIT
